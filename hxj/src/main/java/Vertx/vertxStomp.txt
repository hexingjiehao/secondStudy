1.å­¦ä¹ Vert.x-Stomp:
    1.æ¦‚å¿µï¼šstompæ˜¯é¢å‘ç®€å•æ–‡æœ¬æˆ–è€…æµæ–‡æœ¬çš„æ¶ˆæ¯åè®®ã€‚vert.x-stompæ˜¯StompæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„ä¸€ä¸ªå®ç°ã€‚
    2.ä¾èµ–ï¼š<dependency>
                <groupId>io.vertx</groupId>
                <artifactId>vertx-stomp</artifactId>
                <version>3.8.2</version>
           </dependency>
    3.stompæœåŠ¡å™¨ï¼š
        //é»˜è®¤å®¶ç›‘å¬ç«¯å£61613
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx))
            .listen();

        //å¯ä»¥è®¾ç½®ç«¯å£å’Œä¸»æœºã€‚ç«¯å£è®¾ç½®ä¸º-1,åˆ™æœåŠ¡å™¨ä¸ä¼šå¯åŠ¨ã€‚ç¬¬äºŒä¸ªå‚æ•°ä¸ºç½‘ç»œæœåŠ¡å™¨
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx))
            .listen(1234, "0.0.0.0");
        StompServer server = StompServer.create(vertx, new StompServerOptions()
                                                            .setPort(1234)
                                                            .setHost("0.0.0.0"))
            .handler(StompServerHandler.create(vertx))
            .listen();

        //åˆ¤æ–­æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨æˆåŠŸ
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx))
            .listen(ar -> {
              if (ar.failed()) {
              } else {
              }
            });

        //å…³é—­æœåŠ¡å™¨ï¼š
        server.close(ar -> {
          if (ar.succeeded()) {
          } else {
          }});

        //æœåŠ¡å™¨é…ç½®ï¼šé…ç½®äº†secureåˆ™éœ€è¦provider
        StompServer server = StompServer.create(vertx, new StompServerOptions()
                .setHeartbeat(new JsonObject()
                                    .put("x", 1000)
                                    .put("y", 1000))
                             )
                .setSecured(true)
            .handler( StompServerHandler.create(vertx).authProvider(provider) )
            .listen();

        //æ¶ˆæ¯è®¢é˜…ï¼šï¼ˆé»˜è®¤å‘ç»™æ‰€æœ‰è®¢é˜…è€…ï¼‰
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx)
                .destinationFactory((v, name) -> {
                  if (name.startsWith("/queue")) {
                    return Destination.queue(vertx, name);  //é˜Ÿåˆ—å½¢å¼ï¼Œå¾ªç¯ç­–ç•¥åˆ†å‘æ¶ˆæ¯
                  } else if{
                    return Destination.topic(vertx, name);  //ä¸»é¢˜å½¢å¼
                  } else {
                    return null;  //æ‹’ç»åˆ›å»ºç›®çš„åœ°
                  }
                }))
            .listen();

        //æ¶ˆæ¯ç¡®è®¤
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx)
                .onAckHandler(acknowledgement -> {

                })
                .onNackHandler(acknowledgement -> {

                }))
            .listen();

    4.stompå®¢æˆ·ç«¯ï¼š
        //åˆ›å»ºå®¢æˆ·ç«¯
        StompClient client = StompClient.create(vertx)
            .errorFrameHandler(frame -> {
                //é”™è¯¯å¤„ç†
            })
            .connect(61613,"0.0.0.0",ar -> {
              if (ar.succeeded()) {
                StompClientConnection connection = ar.result();
              } else {
              }
            });

        StompClient client = StompClient.create(vertx, new StompClientOptions()
                                                            .setHost("localhost")
                                                            .setPort(1234))
            .connect(ar -> {
              if (ar.succeeded()) {
                StompClientConnection connection = ar.result();

              } else {
                System.out.println("Failed to connect to the STOMP server: " + ar.cause().toString());
              }
            });

        //å…³é—­å®¢æˆ·ç«¯
        client.close();  //æ–­å¼€è¿æ¥æ²¡æœ‰é€šçŸ¥åˆ°æœåŠ¡å™¨ã€‚å…³é—­ä¸å¹²è„†ã€‚å¯èƒ½åªæ˜¯è®¾ç½®ä¸ºnull
        StompClientConnection connection = ar.result();
        connection.disconnect();

        //å¤„ç†é”™è¯¯
        StompClient client = StompClient.create(vertx, new StompClientOptions()
                                                        .setHost("localhost")
                                                        .setPort(1234))
            .connect(ar -> {
              if (ar.succeeded()) {
                StompClientConnection connection = ar.result();
                connection.errorHandler(frame -> System.out.println("ERROR frame received : " + frame));
              } else {

              }
            });

        //å‘é€æ¶ˆæ¯è¢«å¤„ç†è¿æ¥é”™è¯¯ï¼šğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿
        StompClient client = StompClient.create(vertx)
            .connect(ar -> {
              if (ar.succeeded()) {
                StompClientConnection connection = ar.result();
                connection.connectionDroppedHandler(con -> {

                });

                connection.send("/queue", Buffer.buffer("Hello"),
                    frame -> {
                      System.out.println("Message processed by the server");
                    }
                );
              } else {
              }
            });

        //è®¢é˜…ç›®çš„åœ°ï¼šå®¢æˆ·ç«¯åŒ…æ‹¬æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…
        StompClientConnection connection = ar.result();
        connection.subscribe("/queue",frame -> {}));
        //å–æ¶ˆè®¢é˜…
        connection.unsubscribe("/queue");

        //å‘é€æ¶ˆæ¯
        tompClientConnection connection = ar.result();
        Map<String, String> headers = new HashMap<>();
        headers.put("header1", "value1");
        connection.send("/queue", headers, Buffer.buffer("Hello"));
        connection.send("/queue", Buffer.buffer("World"));

        //æ¶ˆæ¯è®¢é˜…ç¡®è®¤
        StompClientConnection connection = ar.result();
        connection.subscribe("/queue", frame -> {
          connection.ack(frame.getAck());
          connection.nack(frame.getAck());
        });

        //æ¶ˆæ¯çš„äº‹åŠ¡
        StompClientConnection connection = ar.result();
        Map<String, String> headers = new HashMap<>();
        headers.put("transaction", "my-transaction");
        connection.beginTX("my-transaction");
        connection.send("/queue", headers, Buffer.buffer("Hello"));
        connection.send("/queue", headers, Buffer.buffer("World"));
        connection.send("/queue", headers, Buffer.buffer("!!!"));
        connection.commit("my-transaction");

        connection.abort("my-transaction");

    5.ä½¿ç”¨stompæœåŠ¡å™¨ä½œä¸ºæ¡¥æ¢è¿æ¥vert.xäº‹ä»¶æ€»çº¿
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx)
                .bridge(new BridgeOptions()
                    .addInboundPermitted(new PermittedOptions().setAddress("/toBus"))
                    .addOutboundPermitted(new PermittedOptions().setAddress("/toStomp"))
                )
            )
            .listen();

    6.ä½¿ç”¨stompæœåŠ¡å™¨ç»„åˆweb sockets {æ¯”å¦‚stompjs}
        StompServer server = StompServer.create(vertx, new StompServerOptions()
            .setPort(-1)
            .setWebsocketBridge(true)
            .setWebsocketPath("/stomp"))
            .handler(StompServerHandler.create(vertx));

        HttpServer http = vertx.createHttpServer(
            new HttpServerOptions().setWebsocketSubProtocols("v10.stomp, v11.stomp")
        )
            .websocketHandler(server.webSocketHandler())
            .listen(8080);

        //åœ¨javascriptä¸­è¿æ¥stompæœåŠ¡å™¨
        var url = "ws://localhost:8080/stomp";
        var client = Stomp.client(url);
        var callback = function(frame) {
          console.log(frame);
        };

        client.connect({}, function() {
        var subscription = client.subscribe("foo", callback);
        });

    7.æ³¨å†Œæ¥æ”¶å’Œè¯»å†™å¸§å¥æŸ„: {åœ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš†å¯æ“ä½œ}
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx)
                .receivedFrameHandler(sf -> {})
                )
            .listen();
        StompClient client = StompClient.create(vertx)
                                    .receivedFrameHandler(frame -> {});

        //å†™æ“ä½œ
        StompServer server = StompServer.create(vertx)
            .handler(StompServerHandler.create(vertx))
                                .writingFrameHandler(sf -> {})
            .listen();
        StompClient client = StompClient.create(vertx)
            .writingFrameHandler(frame -> {});
