1.å­¦ä¹ vertx-health-checkçš„è¯­æ³•ï¼š
    1. æ¦‚å¿µï¼šå®ƒæ˜¯ä¸€ä¸ªç”¨äºæ£€æŸ¥åº”ç”¨ç¨‹åºçŠ¶æ€çš„ç»„ä»¶ã€‚å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å’Œvertx webæˆ–è€…eventbusç»„åˆä½¿ç”¨ã€‚
    2. ä½¿ç”¨ä¾èµ–ï¼š<dependency>
                 <groupId>io.vertx</groupId>
                 <artifactId>vertx-health-check</artifactId>
                 <version>3.8.0</version>
               </dependency>
    3. åˆ›å»ºhealth checkå¯¹è±¡
        HealthChecks hc = HealthChecks.create(vertx);
        hc.register("my-procedure", future -> future.complete(Status.OK()));
        //è®¾ç½®è¶…æ—¶æ¯«ç§’ï¼Œè¶…æ—¶åˆ™è¿”å›å¤±è´¥
        hc.register("my-procedure", 2000, future -> future.complete(Status.OK()));
    4. æ³¨å†Œvert.x webå¥æŸ„
        HealthCheckHandler healthCheckHandler1 = HealthCheckHandler.create(vertx);
        HealthCheckHandler healthCheckHandler2 = HealthCheckHandler.createWithHealthChecks(HealthChecks.create(vertx));

        //åœ¨ç¡®å®šè·¯ç”±ç»‘å®šå…³ç³»æ—¶è¿›è¡Œå¥åº·æ£€æŸ¥--ç»å¸¸å»è®¿é—®è¯¥è·¯ç”±æ˜¯å¦æ­£å¸¸è¿”å›
        Router router = Router.router(vertx);
        router.get("/health*").handler(healthCheckHandler1);
        router.get("/ping*").handler(healthCheckHandler2);

        HealthCheckHandler healthCheckHandler = HealthCheckHandler.create(vertx);
        healthCheckHandler.register("my-procedure-name", future -> {
            //æˆåŠŸ
          future.complete(Status.OK());
            //å¤±è´¥
          future.complete(Status.KO());
        });

        //æ ‡å‡†æ ¼å¼
        healthCheckHandler.register("my-procedure-name-with-timeout", 2000, future -> {
          future.complete(Status.OK());
          future.complete(Status.KO());
        });
        router.get("/health").handler(healthCheckHandler);

    5. ä½¿ç”¨Procedures--æœ¬è´¨æ˜¯ä¸€ä¸ªæ£€æŸ¥å¥åº·çŠ¶å†µçš„å‡½æ•°
            å¦‚æœfutureæ ‡è®°å¤±è´¥ï¼Œcheckå½“ä½œKO
            å¦‚æœfutureæˆåŠŸå®Œæˆï¼Œä½†æ˜¯æ²¡æœ‰Statusï¼Œcheckå½“ä½œOK
            å¦‚æœfutureæˆåŠŸå®Œæˆï¼Œè€Œä¸”Statusæ ‡è®°OKï¼Œcheckå½“ä½œOK
            å¦‚æœfutureæˆåŠŸå®Œæˆï¼Œä½†æ˜¯Statusæ ‡è®°KOï¼Œcheckå½“ä½œKO

        åŸºæœ¬æ­¥éª¤ï¼š
            5.1 åˆ›å»ºå¯¹è±¡
            5.2 æ³¨å†Œå¥æŸ„å‡½æ•°
            5.3 ç»‘å®šè·¯ç”±
            HealthCheckHandler healthCheckHandler = HealthCheckHandler.create(vertx);
            healthCheckHandler.register("my-procedure-name", future -> {
              future.complete(Status.OK(new JsonObject().put("available-memory", "2mb")));
            });
            healthCheckHandler.register("my-second-procedure-name", future -> {
              future.complete(Status.KO(new JsonObject().put("load", 99)));
            });
            router.get("/health").handler(healthCheckHandler);

        ä»¥/è¿›è¡Œåˆ†ç»„ï¼š
            HealthCheckHandler healthCheckHandler = HealthCheckHandler.create(vertx);
            healthCheckHandler.register("a-group/my-procedure-name", future -> {
              //....
            });
            healthCheckHandler.register("a-group/a-second-group/my-second-procedure-name", future -> {
              //....
            });
            router.get("/health").handler(healthCheckHandler);

    6. httpå“åº”å’Œjsonè¾“å‡º
        å¦‚æœæ²¡æœ‰æ³¨å†Œä»»ä½•è¿‡ç¨‹ï¼Œåˆ™å“åº”æ˜¯204 - no CONTENTï¼Œè¡¨ç¤ºç³»ç»Ÿå·²ç»å¯åŠ¨ï¼Œä½†æ˜¯æ²¡æœ‰æ‰§è¡Œä»»ä½•è¿‡ç¨‹ã€‚å“åº”ä¸åŒ…å«æœ‰æ•ˆè´Ÿè½½ã€‚
        å“åº”ç ï¼š200 = ä¸€åˆ‡æ­£å¸¸
               503 = è‡³å°‘ä¸€ä¸ªprocedureæœ‰ä¸å¥åº·çš„çŠ¶æ€
               500 = procedureå·²ç»æŠ›å‡ºé”™è¯¯ä¿¡æ¯
        å…·ä½“çš„å“åº”ç»“æœï¼šåœ¨dataéƒ¨åˆ†æ˜¾ç¤ºå‡ºé”™çš„ä¿¡æ¯
                      {
                        "checks" : [
                        {
                          "id" : "A",
                          "status" : "UP"
                        },
                        {
                          "id" : "B",
                          "status" : "DOWN",
                          "data" : {
                            "some-data" : "some-value"
                          }
                        }
                        ],
                        "outcome" : "DOWN"
                      }

                    {
                    "checks" : [
                    {
                      "id" : "my-group",
                      "status" : "UP",
                      "checks" : [
                      {
                        "id" : "check-2",
                        "status" : "UP",
                      },
                      {
                        "id" : "check-1",
                        "status" : "UP"
                      }]
                    }],
                    "outcome" : "UP"
                    }
    7. Proceduresçš„ä¾‹å­
        JDBCï¼š  handler.register("database",future -> jdbcClient.getConnection(connection -> {
                   if (connection.failed()) {
                     future.fail(connection.cause());
                   } else {
                     connection.result().close();
                     future.complete(Status.OK());
                   }
                 }));
        æœåŠ¡å¯ç”¨æ€§ï¼š
            handler.register("my-service",future -> HttpEndpoint.getClient(discovery,(rec) -> "my-service".equals(rec.getName()),client -> {
                  if (client.failed()) {
                    future.fail(client.cause());
                  } else {
                    client.result().close();
                    future.complete(Status.OK());
                  }
                }));
        Event busï¼šğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿
            handler.register("receiver",future ->
                vertx.eventBus().send("health", "ping", response -> {
                  if (response.succeeded()) {
                    future.complete(Status.OK());
                  } else {
                    future.complete(Status.KO());
                  }
                })
            );
    8. åœ¨event busä¸Šæš´éœ²health checksï¼š
        vertx.eventBus().consumer("health", message -> healthChecks.invoke(message::reply));











































