å­¦ä¹ Vert.x-service-proxyçš„æœåŠ¡ä»£ç†ï¼š
    1.æ¦‚è¦ï¼šå®˜ç½‘åœ°å€https://vertx.io/docs/vertx-service-proxy/java/
          ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†åœ¨event busä¸Šæš´éœ²ä¸€ä¸ªæœåŠ¡ã€‚
          æœåŠ¡ä»£ç†æœºåˆ¶ä¾èµ–äºä»£ç ç”Ÿæˆï¼Œä¿®æ”¹æ¥å£åˆ™éœ€è¦é‡æ–°ç¼–è¯‘ç”Ÿæˆä»£ç ã€‚
    2.èµ„æºä¾èµ–ï¼šcompile 'io.vertx:vertx-service-proxy:3.6.2'
          æˆ–è€… compileOnly 'io.vertx:vertx-codegen:3.6.2'
          æˆ–è€…å¢åŠ ä¸è¯­è¨€ç›¸å…³çš„ä¾èµ–ï¼švertx-lang-groovy
    3.æ ·ä¾‹ä»£ç ï¼š
          ä»£ç†æ¥å£ï¼šJsonObject message = new JsonObject();
                   message.put("collection", "mycollection").put("document", new JsonObject().put("name", "tim"));
                   DeliveryOptions options = new DeliveryOptions().addHeader("action", "save");
                   vertx.eventBus().send("database-service-address", message, options, res2 -> {
                     if (res2.succeeded()) {
                     } else {
                     }
                   });
          ç¼–å†™æ¥å£ï¼šæ³¨è§£@ProxyGen
                @ProxyGen
                public interface SomeDatabaseService {
                  static SomeDatabaseService create(Vertx vertx) {
                    return new SomeDatabaseServiceImpl(vertx);
                  }
                  static SomeDatabaseService createProxy(Vertx vertx,String address) {
                    return new SomeDatabaseServiceVertxEBProxy(vertx, address);
                  }
                  void save(String collection, JsonObject document,Handler<AsyncResult<Void>> resultHandler);
                }
          ä»£ç†ç±»çš„ä½¿ç”¨ï¼šSomeDatabaseService service = SomeDatabaseService.createProxy(vertx,"database-service-address");
                      service.save("mycollection", new JsonObject().put("name", "tim"), res2 -> {
                          if (res2.succeeded()) {

                          }
                      });
          ç»„åˆä½¿ç”¨@ProxyGenå’Œ@VertxGen: @ProxyGen //ç”Ÿæˆä»£ç†
                                       @VertxGen //ç”Ÿæˆå®¢æˆ·ç«¯
                                       public interface SomeDatabaseService {

                                       }
    4.å¼‚æ­¥æ¥å£ï¼šä¸ºäº†ä½¿ç”¨æœåŠ¡ä»£ç†è‡ªåŠ¨ç”Ÿæˆï¼Œæ¥å£å¿…é¡»è¦æœ‰å¼‚æ­¥æ¨¡å¼ã€‚é¦–å…ˆæ–¹æ³•å‚æ•°æ˜¯Handler<AsyncResult<ResultType>>ã€‚
        @ProxyGen
        public interface SomeDatabaseService {
             static SomeDatabaseService create(Vertx vertx) {
               return new SomeDatabaseServiceImpl(vertx);
             }
             static SomeDatabaseService createProxy(Vertx vertx, String address) {
               return new SomeDatabaseServiceVertxEBProxy(vertx, address);
             }
             void save(String collection, JsonObject document,Handler<AsyncResult<Void>> result);
             void findOne(String collection, JsonObject query,Handler<AsyncResult<JsonObject>> result);
             void createConnection(String shoeSize,Handler<AsyncResult<MyDatabaseConnection>> resultHandler);
        }

        @ProxyGen
        @VertxGen
        public interface MyDatabaseConnection {
             void insert(JsonObject someData);
             void commit(Handler<AsyncResult<Void>> resultHandler);
             @ProxyClose
             void close();
        }
    5.ä»£ç ç”Ÿæˆï¼š@ProxyGenä¼šè§¦å‘æœåŠ¡åŠ©æ‰‹ç±»ï¼Œä¸€ä¸ªæ˜¯æœåŠ¡ä»£ç†ï¼Œä¸€ä¸ªæ˜¯æœåŠ¡å¥æŸ„ã€‚éƒ½æ˜¯åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆçš„ã€‚éƒ½å’Œevent busæœ‰å…³ã€‚
        é…å¥—çš„ç±»å’Œæ¥å£ï¼šMyService--> MyServiceProxyHandler--> MyServiceEBProxy
        èµ„æºä¾èµ–ï¼šcompile "io.vertx:vertx-codegen:3.6.2:processor"
                 compile "io.vertx:vertx-service-proxy:3.6.2"
        å°†ä»£ç ç”Ÿæˆå™¨æ”¾å…¥jaråŒ…ä¸­ï¼š<plugin>
                                <artifactId>maven-compiler-plugin</artifactId>
                                <configuration>
                                  <annotationProcessors>
                                    <annotationProcessor>io.vertx.codegen.CodeGenProcessor</annotationProcessor>
                                  </annotationProcessors>
                                </configuration>
                              </plugin>
    6.æš´éœ²æ¥å£ï¼šæ‹¥æœ‰æœåŠ¡æ¥å£æ—¶ï¼Œéœ€è¦æ³¨å†ŒæœåŠ¡åˆ°event busä¸Šã€‚
        ä»£ç ä¸¾ä¾‹ï¼šSomeDatabaseService service = new SomeDatabaseServiceImpl();
                 new ServiceBinder(vertx).setAddress("database-service-address")
                                         .register(SomeDatabaseService.class, service);
        å¯ä»¥ä½¿ç”¨unregisterå–æ¶ˆæ³¨å†Œï¼š
            ServiceBinder binder = new ServiceBinder(vertx);
            SomeDatabaseService service = new SomeDatabaseServiceImpl();
            MessageConsumer<JsonObject> consumer = binder.setAddress("database-service-address")
                                                         .register(SomeDatabaseService.class, service);
            binder.unregister(consumer);
    7.ä»£ç†åˆ›å»ºï¼šä½¿ç”¨ProxyHelperåˆ›å»ºã€‚æ¥å£ä¸­éƒ½æœ‰é™æ€æ–¹æ³•createProxy
        ServiceProxyBuilder builder = new ServiceProxyBuilder(vertx).setAddress("database-service-address");
        SomeDatabaseService service = builder.build(SomeDatabaseService.class);
        SomeDatabaseService service2 = builder.setOptions(options).build(SomeDatabaseService.class);
    8.é”™è¯¯å¤„ç†ï¼šå¯ä»¥æ ¹æ®é”™è¯¯ç å’Œå¼‚å¸¸ç±»å‹å¤„ç†é”™è¯¯ä¿¡æ¯ã€‚å¯ä»¥åœ¨æ³¨å†ŒæœåŠ¡å¤±è´¥æ—¶è¿”å›è‡ªå®šä¹‰å¼‚å¸¸ç±»ã€‚
        resultHandler.handle(ServiceException.fail(CONNECTION_FAILED, result.cause().getMessage()));

        if (result.cause() instanceof ServiceException) {
                ServiceException exc = (ServiceException) result.cause();
                if (exc.failureCode() == SomeDatabaseServiceImpl.BAD_SHOE_SIZE) {
                  handler.handle(Future.failedFuture(
                    new InvalidInputError("You provided a bad shoe size: " +
                      exc.getDebugInfo().getString("shoeSize"))
                  ));
                } else if (exc.failureCode() == SomeDatabaseServiceImpl.CONNECTION) {
                  handler.handle(Future.failedFuture(new ConnectionError("Failed to connect to the DB")));
                }
        } else {
            handler.handle(Future.failedFuture(
                new SystemError("An unexpected error occurred: + " result.cause().getMessage())
            ));
        }
    9.æœåŠ¡æ¥å£é™åˆ¶ï¼š
        è¿”å›ç±»å‹ï¼šå¿…é¡»æ˜¯void å’Œ @Fluenté£æ ¼this
        å‚æ•°ç±»å‹ï¼šJSON = JsonObject|JsonArray, PRIMITIVE=ä»»ä½•ç§æœ‰å°è£…ç±»å‹
            JSON / PRIMITIVE /List<JSON> / List<PRIMITIVE>
            Set<JSON> / Set<PRIMITIVE>
            Map<String, JSON> / Map<String, PRIMITIVE>
            Any Enum type / @DataObjectæ³¨è§£çš„ç±»
        é‡è½½æ–¹æ³•ï¼šä¸èƒ½æœ‰é‡è½½æ–¹æ³•
    10.é€šè¿‡äº‹ä»¶æ€»çº¿è°ƒç”¨æœåŠ¡çš„çº¦å®š(æ²¡æœ‰ä»£ç†):ä½¿ç”¨vertx.
        å…¶ä¸­æœ‰actionï¼Œcollectionï¼Œdocumentï¼Œmessage.reply(...), message.fail(...)

        vertx-service-proxyçš„æœ¬è´¨:ğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿
            1.æœ‰ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬åšäº†ä¸€ä¸ªä¼ªè£…å®ç°ç±»Proxyï¼Œå…·ä½“å®ç°æ˜¯å‘é€æ¶ˆæ¯åˆ°ebä¸Š
            2.æˆ‘ä»¬åœ¨ebä¸Šåšäº†ä¸€ä¸ªçœŸæ­£çš„å®ç°ç±»ã€‚
            3.æˆ‘ä»¬åˆåšäº†ä¸€ä¸ªä»£ç†å®ç°ç±»ï¼ŒåŒ…å«äº†çœŸæ­£å®ç°ç±»ã€‚å®ƒæ¶ˆè´¹ebä¸Šçš„æ¶ˆæ¯ï¼Œæ ¹æ®åå­—çš„ä¸åŒï¼Œè°ƒç”¨ä¸åŒæ–¹æ³•ã€‚
              æœ¬è´¨è¿˜æ˜¯çœŸæ­£å®ç°ç±»çš„çˆ¶ç±»å¼•ç”¨è°ƒç”¨å­ç±»å¯¹è±¡ï¼Œè¿›è¡ŒçœŸæ­£çš„æ–¹æ³•è°ƒç”¨
