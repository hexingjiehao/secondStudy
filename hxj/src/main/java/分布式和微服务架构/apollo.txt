1.å­¦ä¹ apolloåˆ†å¸ƒå¼å…¨å±€é…ç½®: ã€è¿˜æ˜¯è¦å®æˆ˜æ‰èƒ½ç†è§£æ•ˆæœï¼ï¼ï¼ã€‘
    0.githubå®˜ç½‘åœ°å€ï¼šhttps://github.com/ctripcorp/apollo
    1.å®˜æ–¹å®šä¹‰ï¼šApolloï¼ˆé˜¿æ³¢ç½—ï¼‰æ˜¯æºç¨‹æ¡†æ¶éƒ¨é—¨ç ”å‘çš„åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œèƒ½å¤Ÿé›†ä¸­åŒ–ç®¡ç†åº”ç”¨ä¸åŒç¯å¢ƒã€ä¸åŒé›†ç¾¤çš„é…ç½®ï¼Œ
                é…ç½®ä¿®æ”¹åèƒ½å¤Ÿå®æ—¶æ¨é€åˆ°åº”ç”¨ç«¯ï¼Œå¹¶ä¸”å…·å¤‡è§„èŒƒçš„æƒé™ã€æµç¨‹æ²»ç†ç­‰ç‰¹æ€§ï¼Œé€‚ç”¨äºå¾®æœåŠ¡é…ç½®ç®¡ç†åœºæ™¯ã€‚
    2.ä¾èµ–é…ç½®ï¼šjavaå’Œmysql
    3.ä½¿ç”¨æŒ‡å—ï¼š
        2.1 åº”ç”¨æ¥å…¥æŒ‡å—{å¦‚ä½•åœ¨ä¸€ä¸ªç°æœ‰çš„apolloæœåŠ¡å™¨ä¸Šè¿›è¡Œåˆ†å¸ƒå¼é…ç½®}
                â€â€â€é…ç½®åªæœ‰åœ¨å‘å¸ƒã€å›æ»šåŠ¨ä½œåæ‰ä¼šè¢«åº”ç”¨å®é™…ä½¿ç”¨åˆ°ã€‚å•çº¯ä¿®æ”¹ä¸å½±å“åº”ç”¨ã€‚
                åè¯è§£é‡Šï¼š
                    æ™®é€šåº”ç”¨ï¼šç‹¬ç«‹è¿è¡Œç¨‹åºã€‚æ¯”å¦‚webç¨‹åºï¼Œmainç¨‹åº
                    å…¬å…±ç»„ä»¶ï¼šå‘å¸ƒçš„ç±»åº“ã€å®¢æˆ·ç«¯ç¨‹åºï¼Œä¸ä¼šè‡ªå·±ç‹¬ç«‹è¿è¡Œã€‚æ¯”å¦‚Javaçš„jaråŒ…ï¼Œ.Netçš„dllæ–‡ä»¶
                æ™®é€šåº”ç”¨æ¥å…¥apolloæœåŠ¡å™¨ï¼šã€åœ¨æµè§ˆå™¨ç•Œé¢ä¸Šç‚¹å‡»æŒ‰é’®é…ç½®â€â€â€ã€‘
                    1.åœ¨ApolloæœåŠ¡å™¨åˆ›å»ºé¡¹ç›®ï¼šè¾“å…¥ éƒ¨é—¨/â€œappidâ€/åç§°/è´Ÿè´£äºº
                    2.ç„¶åç»™é¡¹ç›®åˆ†é…ä¿®æ”¹æƒé™å’Œå‘å¸ƒæƒé™ğŸ–ğŸ–ğŸ–
                    3.ç»™æŒ‡å®šçš„å‘½åæ§ä»¶å¢åŠ æŒ‡å®šé…ç½®é¡¹ï¼šâ€â€â€
                        è¡¨æ ¼æ·»åŠ ï¼šåˆ›å»º-è¾“å…¥-æäº¤
                        æ–‡æœ¬æ·»åŠ ï¼šå¯ä»¥ç”¨propertiesæ•´ä¸ªæ·»åŠ 
                    4.å°†æ·»åŠ å¥½çš„é…ç½®ï¼Œè¿›è¡Œå‘å¸ƒï¼Œé€šçŸ¥åˆ°åµŒå…¥åº”ç”¨ç¨‹åºçš„apolloå®¢æˆ·ç«¯
                    6.apolloå®¢æˆ·ç«¯è¯»å–é…ç½®ï¼šjavaå®¢æˆ·ç«¯æˆ–è€…httpæ¥å£
                        javaå®¢æˆ·ç«¯ä½¿ç”¨æ–‡æ¡£ï¼šhttps://github.com/ctripcorp/apollo/wiki/Java%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97
                    7.å›æ»šå·²å‘å¸ƒé…ç½®ï¼šâ€å®¢æˆ·ç«¯ä¸ä¼šå­˜é…ç½®ç‰ˆæœ¬ä¿¡æ¯ï¼Œåªæœ‰æœåŠ¡å™¨ç«¯æ‰æœ‰â€œ
                        å°†å‘å¸ƒåˆ°å®¢æˆ·ç«¯çš„é…ç½®å›æ»šåˆ°ä¸Šä¸€ä¸ªå·²å‘å¸ƒç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´å®¢æˆ·ç«¯è¯»å–åˆ°çš„é…ç½®ä¼šæ¢å¤åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œä½†é¡µé¢ä¸Šç¼–è¾‘çŠ¶æ€çš„é…ç½®æ˜¯ä¸ä¼šå›æ»šçš„ï¼Œä»è€Œå¼€å‘å¯ä»¥åœ¨ä¿®å¤é…ç½®åé‡æ–°å‘å¸ƒã€‚
                å…¬å…±ç»„ä»¶æ¥å…¥çš„åŒºåˆ«ï¼šéœ€è¦åˆ›å»ºè‡ªå·±å”¯ä¸€çš„Namespaceã€‚è¿™éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚Namespaceæ˜¯ä¸€ä¸ªæ›´å¤§çš„ç©ºé—´ã€‚
                åº”ç”¨è¦†ç›–å…¬ç”¨ç»„ä»¶é…ç½®æ­¥éª¤ï¼š
                    1.åº”ç”¨é…ç½®åˆ›å»ºï¼Œå…¬ç”¨ç»„ä»¶é…ç½®åˆ›å»ºï¼ŒäºŒè€…çš„namespaceè¿›è¡Œå…³è”
                é›†ç¾¤ç‹¬ç«‹é…ç½®è¯´æ˜ï¼šâ€â€â€
                    1.åˆ›å»ºé›†ç¾¤
                    2.é›†ç¾¤è®¾ç½®ç¯å¢ƒ
                    3.é›†ç¾¤åˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œå¹¶å‘å¸ƒ
                å¤šä¸ªåº”ç”¨ä½¿ç”¨åŒä¸€ä¸ªé…ç½®ï¼šâ€â€â€ã€ä¸€ä¸ªé¡¹ç›®ä¸­çš„å¤šä¸ªæ¨¡å—ã€‘
                    å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨å…¶ä¸­ä¸€ä¸ªAppIdä¸‹åˆ›å»ºä¸€ä¸ªnamespaceï¼Œå†™å…¥å…¬å…±çš„é…ç½®ä¿¡æ¯ï¼›
                    ç„¶ååœ¨å„ä¸ªé¡¹ç›®ä¸­è¯»å–è¯¥namespaceçš„é…ç½®å³å¯ã€‚
                ç°åº¦å‘å¸ƒï¼š{ç›®çš„æ˜¯å¤šå°æœºå™¨ï¼Œé€‰ä¸€å°è¯•è¯•æ–°çš„é…ç½®æ˜¯å¦æ›´å¥½}â€â€â€
                    1.åœ¨å‘½åç©ºé—´åˆ›å»ºç°åº¦
                    2.å¯¹æŸä¸ªé…ç½®è¿›è¡Œç°åº¦æ“ä½œ
                    3.å¯ä»¥æ–°å¢ç°åº¦è§„åˆ™ï¼šä¹Ÿå°±æ˜¯é‚£äº›ipç”µè„‘ä¼šè¢«ç°åº¦å‘å¸ƒ
                å…¨é‡å‘å¸ƒï¼š{å°†ç°åº¦å‘å¸ƒåˆå¹¶åˆ°ä¸»åˆ†æ”¯ä¸Š}
        2.2 javaå®¢æˆ·ç«¯ä½¿ç”¨æŒ‡å—{å¦‚ä½•åœ¨javaé¡¹ç›®ä¸­ä½¿ç”¨aplloé…ç½®}â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€
                AppIdå±æ€§çš„é…ç½®ä»é«˜åˆ°ä½ï¼š
                    ç³»ç»Ÿå±æ€§ï¼š-Dapp.id=YOUR-APP-ID
                    ç¯å¢ƒå˜é‡ï¼šAPP_ID=YOUR-APP-ID
                    application.propertiesæ–‡ä»¶ï¼š app.id=YOUR-APP-ID
                    classpath:/META-INF/app.propertiesæ–‡ä»¶ï¼šapp.id=YOUR-APP-ID
                Apoll Meta Serverå±æ€§çš„é…ç½®ä»é«˜åˆ°ä½ï¼š
                    ç³»ç»Ÿå±æ€§ï¼šapollo.meta=
                    jvmå‚æ•°ï¼š-Dapollo.meta=http://config-service-url
                    è¿è¡Œjaræ–‡ä»¶ï¼šjava -Dapollo.meta=http://config-service-url -jar xxx.jar
                    ç¨‹åºæŒ‡å®šï¼šSystem.setProperty("apollo.meta", "http://config-service-url");
                    application.propertiesæˆ–bootstrap.propertiesæ–‡ä»¶ï¼šapollo.meta=http://config-service-url
                    ç¯å¢ƒå˜é‡ï¼šAPOLLO_META
                    server.propertiesæ–‡ä»¶ï¼šapollo.meta=http://config-service-url
                        å¯¹äºMac/Linuxï¼Œæ–‡ä»¶ä½ç½®ä¸º/opt/settings/server.properties
                        å¯¹äºWindowsï¼Œæ–‡ä»¶ä½ç½®ä¸ºC:\opt\settings\server.properties
                    classpath:/META-INF/app.propertiesæ–‡ä»¶ï¼šapollo.meta=http://config-service-url
                    javaç³»ç»Ÿå±æ€§ï¼š-Ddev_meta=http://config-service-url
                    ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼šDEV_META=http://config-service-url
                    apollo-env.propertiesæ–‡ä»¶ï¼š
                        dev.meta=http://1.1.1.1:8080
                        fat.meta=http://apollo.fat.xxx.com
                        uat.meta=http://apollo.uat.xxx.com
                        pro.meta=http://apollo.xxx.com
                    è§„åˆ™æ˜¯è¾ƒå°çš„Orderå…·æœ‰è¾ƒé«˜çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤Order=0çš„MetaServerProviderä¼šæ’åœ¨Order=1çš„MetaServerProviderçš„å‰é¢ã€‚
                    apolloçš„æ— æ–‡ä»¶é…ç½®ï¼šâ€â€â€â€â€
                        å†™ä¸€ä¸ªé¡¹ç›®ï¼šé‡Œé¢ä¾èµ–apollo-client.jarã€‚ä½¿ç”¨spiä»£ç å†™é…ç½®ã€‚ç„¶ååº”ç”¨ä¾èµ–è¯¥é¡¹ç›®
                æœ¬åœ°ç¼“å­˜è·¯å¾„ï¼šâ€â€â€â€â€
                    Apolloå®¢æˆ·ç«¯ä¼šæŠŠä»æœåŠ¡ç«¯è·å–åˆ°çš„é…ç½®åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¸€ä»½ï¼Œç”¨äºåœ¨é‡åˆ°æœåŠ¡ä¸å¯ç”¨ï¼Œ
                    æˆ–ç½‘ç»œä¸é€šçš„æ—¶å€™ï¼Œä¾ç„¶èƒ½ä»æœ¬åœ°æ¢å¤é…ç½®ï¼Œä¸å½±å“åº”ç”¨æ­£å¸¸è¿è¡Œã€‚
                    æœ¬åœ°çš„ç¼“å­˜ä½ç½®ï¼šC:\opt\data\{appId}\config-cacheã€‚  æ ¼å¼ä¸º{appId}+{cluster}+{namespace}.properties
                å¼€å§‹ä½¿ç”¨ä»£ç ä¾èµ–ï¼š
                    <dependency>
                        <groupId>com.ctrip.framework.apollo</groupId>
                        <artifactId>apollo-client</artifactId>
                        <version>1.1.0</version>
                    </dependency>
                apolloé…ç½®åœ¨ä»£ç ä¸­çš„ä½¿ç”¨æ–¹å¼ï¼š
                    1.@value
                    2.å ä½ç¬¦
                    3.apolloæ‰˜ç®¡springçš„é…ç½®ã€‚å°†é…ç½®æ–‡ä»¶æ”¾åœ¨apolloä¸Šã€‚
                    4.æ³¨è§£ï¼š@ApolloConfig
                            private Config config;
                apiæ–¹å¼åœ¨ä»£ç ä¸­è·å–é…ç½®ï¼š
                    Config config = ConfigService.getAppConfig();
                    String someKey = "someKeyFromDefaultNamespace";
                    String someDefaultValue = "someDefaultValueForTheKey";
                    String value = config.getProperty(someKey, someDefaultValue);
                ä»£ç ç›‘å¬é…ç½®æ–‡ä»¶çš„åŠ¨æ€å˜åŒ–ï¼š
                    Config config = ConfigService.getAppConfig();
                    config.addChangeListener(new ConfigChangeListener() {
                        @Override
                        public void onChange(ConfigChangeEvent changeEvent) {
                            System.out.println("Changes for namespace " + changeEvent.getNamespace());
                            for (String key : changeEvent.changedKeys()) {
                                ConfigChange change = changeEvent.getChange(key);
                                System.out.println(String.format("Found change - key: %s, oldValue: %s, newValue: %s, changeType: %s", change.getPropertyName(), change.getOldValue(), change.getNewValue(), change.getChangeType()));
                            }
                        }
                    });
                éå¸¸é‡è¦çš„ä»£ç é…ç½®ï¼šåŸºäºjavaçš„é…ç½®(æ¨è)--ä¸¤ä¸ªæ³¨è§£åŒæ—¶ä½¿ç”¨æ‰ç”Ÿæ•ˆã€‚
                    //è¿™ä¸ªæ˜¯æœ€ç®€å•çš„é…ç½®å½¢å¼ï¼Œä¸€èˆ¬åº”ç”¨ç”¨è¿™ç§å½¢å¼å°±å¯ä»¥äº†ï¼Œç”¨æ¥æŒ‡ç¤ºApolloæ³¨å…¥application namespaceçš„é…ç½®åˆ°Springç¯å¢ƒä¸­
                    @Configuration
                    @EnableApolloConfig
                    public class AppConfig {
                      @Bean
                      public TestJavaConfigBean javaConfigBean() {
                        return new TestJavaConfigBean();
                      }
                    }
        2.3 apolloçš„ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹ä»£ç 
    4.è®¾è®¡åŸç†ï¼š
        apolloçš„7å¤§æ¨¡å—ï¼š4å¤§åŠŸèƒ½+3å¤§è¾…åŠ©
            ConfigService: å®¢æˆ·ç«¯ï¼Œé…ç½®å†…å®¹çš„è¯»å–å’Œæ¨é€æ¥å£
            AdminService: é…ç½®å†…å®¹çš„ç®¡ç†å’Œå‘å¸ƒ
            Client: å®æ—¶æ›´æ–°é…ç½®å†…å®¹ï¼Œè°ƒç”¨ConfigService
            Portal: ç®¡ç†ç•Œé¢ï¼Œè°ƒç”¨AdminService

            Eureka: å°†ConfigServiceå’ŒAdminServiceæœåŠ¡æ³¨å†Œå’Œå‘ç°
            MetaServer: ç›¸å½“äºEureka Proxyã€‚Portalé€šè¿‡å®ƒè®¿é—®AdminServiceï¼ŒClienté€šè¿‡å®ƒè®¿é—®ConfigService
            NginxLB: ååŠ©åŸŸåç³»ç»Ÿè¿›è¡Œè´Ÿè½½å‡è¡¡
        ç²¾å½©çš„Apolloæ¶æ„åˆ†æï¼š
            https://mp.weixin.qq.com/s/-hUaQPzfsl9Lm3IqQW3VDQ
    5.å¼€å‘æŒ‡å—ï¼š
        Apolloçš„æºç è§£æï¼šhttp://www.iocoder.cn/categories/Apollo/
        springboot + Apolloçš„Demoå®æˆ˜ï¼šhttp://www.iocoder.cn/Apollo/install/   ã€éªŒè¯ç ï¼šcokeã€‘
        å¿«é€Ÿå¯åŠ¨Apolloï¼šhttps://github.com/ctripcorp/apollo/wiki/Quick-Start ã€æ¨èâ€â€â€â€â€ã€‘
        dockerå¿«é€Ÿéƒ¨ç½²Apolloï¼šhttps://github.com/ctripcorp/apollo/wiki/Apollo-Quick-Start-Docker%E9%83%A8%E7%BD%B2 ã€æ¨èâ€â€â€â€â€ã€‘
    6.éƒ¨ç½²æŒ‡å—ï¼š
    7.å¸¸è§é—®é¢˜ï¼š
    8.apolloçš„å‰ä¸–ä»Šç”Ÿï¼š


å®æˆ˜æ“ä½œï¼šâ€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€
    1.apolloçš„dockerçš„yamlæ–‡ä»¶ï¼š
        version: '2'
        services:
          apollo-quick-start:
            image: nobodyiam/apollo-quick-start
            container_name: apollo-quick-start
            depends_on:
              - apollo-db
            ports:
              - "8080:8080"
              - "8070:8070"
            links:
              - apollo-db
          apollo-db:
            image: mysql:5.7
            container_name: apollo-db
            environment:
              TZ: Asia/Shanghai
              MYSQL_ALLOW_EMPTY_PASSWORD: 'yes'
            depends_on:
              - apollo-dbdata
            ports:
              - "13306:3306"
            volumes:
              - ./sql:/docker-entrypoint-initdb.d
            volumes_from:
              - apollo-dbdata
          apollo-dbdata:
            image: alpine:latest
            container_name: apollo-dbdata
            volumes:
              - /var/lib/mysql

    2.dockerå…³è”mysqlç”¨æˆ·åå¯†ç ï¼š
        ç«¯å£ï¼š13306
        ç”¨æˆ·åï¼šroot
        å¯†ç ç•™ç©º
        ç™»å½•å‘½ä»¤ï¼šdocker exec -it apollo-quick-start bash
        dockerä¸Šçš„æ—¥å¿—ï¼š/apollo-quick-start/service
                        /apollo-quick-start/portal
        è¿è¡Œapolloå®¢æˆ·ç«¯: docker exec -i apollo-quick-start /apollo-quick-start/demo.sh client
        æ‰§è¡Œæ•ˆæœï¼šè‡ªå¸¦eureka,èƒ½å¤Ÿåœ¨localhost:8080çœ‹åˆ°æ³¨å†Œçš„ä¸¤ä¸ªæœåŠ¡
        æœåŠ¡å™¨ç«¯ç•Œé¢ï¼šhttp://localhost:8070/signin
            ç”¨æˆ·åï¼šapollo
            å¯†ç ï¼šadmin
