1.sqlçš„äº‹åŠ¡çš„å¤„ç†è¿‡ç¨‹ï¼š
    1.åŸåˆ™ï¼š
        1.1 å½“é‡åˆ°å¹¶è¡Œfutureçš„æ—¶å€™ï¼Œæ€»ä¹‹ï¼Œå°†å…¶è½¬åŒ–ä¸ºé¡ºåºæ‰§è¡Œï¼Œå¦‚æœè¯¥futureä¸­æœ‰å¤šä¸ªæ“ä½œï¼Œé‚£ä¹ˆåç»­çš„æ¯ä¸ªæ“ä½œéƒ½æ˜¯queryBatch;
        1.2 å½“é‡åˆ°äºŒé‡å¾ªç¯çš„futureæ—¶ï¼Œå°†æœ€å¤–å±‚çš„å¾ªç¯çš„æ•°æ®ç»“æ„è¿›è¡Œé‡æ„ï¼Œå°†é‡Œå±‚æ•°æ®éœ€è¦çš„æ•°æ®ï¼Œåœ¨æœ€å¼€å§‹å°±ä¼ å…¥è¿›è¡Œï¼›
    2.æ¨¡å¼åŒ–çš„äº‹åŠ¡ä»£ç ï¼šğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿ğŸŒ¿
        âš ï¸âš ï¸âš ï¸ï¼šäº‹åŠ¡å¤±è´¥çš„æ—¶å€™ï¼Œä½¿ç”¨tx.commit()å’Œä½¿ç”¨tx.rollback()çš„æ•ˆæœæ˜¯ä¸€æ ·çš„
                 å¹¶è¡Œfutureä¸­çš„å¤šä¸ªäº‹åŠ¡ï¼Œæœ€å¥½åœ¨futureå†…éƒ¨å°±æŠŠäº‹åŠ¡æäº¤äº†æˆ–è€…å›æ»š
        2.1 æŸ¥è¯¢æ“ä½œï¼šã€å½“sqlå¤±è´¥çš„æ—¶å€™ï¼Œtx.commitï¼Œä½†æ˜¯futureè¦è®©å®ƒå¤±è´¥ï¼ŒæˆåŠŸäº†ä¹Ÿä¸è¦ç«‹åˆ»è¿›è¡Œtx.commitã€‘
              private Future<Void> setProductsCustomer() {
                var promise = Promise.<Void>promise();

                tx.queryOneOrNone("getOrderById", Tuple.of(realm, orderId), collectDataObject(xxx.class), ar -> {
                  if (ar.succeeded()) {
                    promise.complete();
                  } else {
                    tx.commit();
                    promise.fail(ar.cause());
                  }
                });
                return promise.future();
              }
        2.2 ä¿®æ”¹æ“ä½œï¼š
              private Future<Void> publishMaterials() {
                var promise = Promise.<Void>promise();

                tx.queryBatch("changeMaterialStatus", tuples, ar -> {
                  if (ar.succeeded()) {
                    promise.complete(ar.result());
                  } else {
                    tx.commit();
                    promise.fail(ar.cause());
                  }
                });
                return promise.future();
              }
        2.3 æ‰¹é‡æ‰§è¡Œsqlä¸­ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæœ‰é—®é¢˜çš„å¤„ç†ï¼šã€æ•´ä½“å¤±è´¥ï¼Œè¿˜æ˜¯ç…§æ ·commitï¼Œä½†æ˜¯éƒ¨åˆ†æˆåŠŸçš„ç»“æœï¼Œéœ€è¦é¢å¤–åˆ¤æ–­ï¼Œè¿™æ—¶å€™éœ€è¦çš„æ˜¯tx.rollbackï¼Œå¹¶æŠ›å‡º500å¼‚å¸¸ã€‘
              private Future<List<Long>> createMaterials() {
                var promise = Promise.<List<Long>>promise();

                tx.queryBatch("createMaterial", tuples, collectLong(), ar -> {
                  if (ar.succeeded()) {
                    var materails = ar.result();

                    if (materails.size() == list.size()) {
                      promise.complete(materails);
                    } else {
                      tx.rollback();
                      promise.fail(FailureUtils.create(500, FAILURE_TITLE, "xxx"));
                    }
                  } else {
                    tx.commit();
                    promise.fail(ar.cause());
                  }
                });
                return promise.future();
              }
        2.4 åœ¨ésqléƒ¨åˆ†çš„æ£€æŸ¥å‡ºé”™çš„å¤„ç†ï¼š
            if (partMap.containsKey(number)) {
                tx.rollback();
                return FailureUtils.createClientError(FAILURE_TITLE, "xxxx");
            } else {
                ......
            }
        2.5 åœ¨é¡ºåºæ‰§è¡Œçš„futureçš„æœ€åï¼Œæ·»åŠ æäº¤æ“ä½œï¼š
            .compose(v -> Future.future(tx::commit));
        2.6 å¦‚æœå·²ç»åœ¨æœ€å¤–å±‚çš„txåŒ…å«äº†ï¼Œé‚£ä¹ˆå†…éƒ¨æœ€å¥½å…¨éƒ¨éƒ½å˜æˆé¡ºåºæ‰§è¡Œï¼›
            åä¹‹ï¼Œæ²¡è¢«äº‹åŠ¡åŒ…å«ï¼Œå¼€å¯å¹¶è¡Œfutureæ“ä½œï¼Œå•ç‹¬çš„futureä¸­å¦‚æœæœ‰äº‹åŠ¡ï¼Œæœ€å¥½åœ¨è¯¥futureä¸­å°±è¿›è¡Œæäº¤æˆ–è€…å›æ»šã€‚
